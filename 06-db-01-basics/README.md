# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
    #### Решение
    Документоориентированная БД (document-oriented database) подходит для решения этой задачи так как она специально предназначена для хранения иерархических структур данных (документов).

- Склады и автомобильные дороги для логистической компании
    #### Решение
    Графовая БД (Graph database) позволяет решать логистические задачи так как это задача с естественной графовой структурой.
    
- Генеалогические деревья
    #### Решение
    Графовая БД (Graph database) также позволяет решать задачи построения и использования генеологических деревьев так как данную БД используют в социальных сетях, а эта задача сходна с ней.

- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
    #### Решение
    База данных «ключ-значение» (Key–value database) подходит так как мы имеем ключ (ID клиента, номер сессии) и значение, которое может иметь время жизни объекта, что типично для этого типа БД (Memcached, Redis).

- Отношения клиент-покупка для интернет-магазина
    #### Решение
    Реляционная БД, так как здесь имеется отношение между таблицей клиентов и покупок и требуется долгосрочное хранение и выборка из данного типа БД. 

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
    #### Решение
    Данная система является несогласованной с точки зрения теоремы CAP, так как в каждый момент времени данные на разных узлах противоречат друг другу. Это может быть AP, если допустить, что доступность и устойчивость к разделению достигается, но в условии ничего про это нет. 

    В PACELC: PA и EL.
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
    #### Решение
    Если система может разделиться на два рабочих кластера, то это доступная система устойчивая к разделению (PA) в теореме CAP. 

    В PACELC: PA и EC.

- Система может не прислать корректный ответ или сбросить соединение
    #### Решение
    Данная система не является доступной, значит она может быть CP по теореме CAP, если согласованность и устойчивость к разделению обеспечивается.

    В PACELC: PC и EC.


А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

#### Решение
Если под одной системой подразумевается приложение, то, однозначно, можно использовать разные виды БД. Если же подразумевается конкретная БД, то конкретные реализации BASE баз данных могут нарушать разные базовые принципы ACID и, таким образом, некоторые свойства могут быть соблюдены. Например, некоторая BASE система может поддерживать атомарность, но не давать гарантии изоляций. Например, MongoDB поддерживает как BASE так и ACID транзакции. 

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?

#### Решение
Данную задачу можно решить с использованием Redis так как это система ключ-значение и значениям можно присваивать Time-To-Live (время жизни значения).

Система `Pub/Sub` (publisher-subscriber) это шаблон проектирования передачи сообщений, при котором отправители сообщений не связаны с получателями сообщений напрямую, но они связаны через классы сообщений.

В указанной статье [Pub/Sub](https://habr.com/ru/post/278237/) указывается следующий недостаток:
> ZeroMQ и Redis довольно новые системы и постоянно находятся в стадии усовершенствований. Это накладывает свою специфику именно в отношении надежности. Известны массивные системы, реализованные на их базе, но для создания подобных систем обязательно нужны программисты хорошего уровня.